<?xml version="1.0" ?><!DOCTYPE extension  PUBLIC '-//QM/2.3/Extension//EN'  'http://www.codesourcery.com/qm/dtds/2.3/-//qm/2.3/extension//en.dtd'>
<extension class="GaudiTest.GaudiExeTest" kind="test">
  <argument name="program"><text>gaudirun.py</text></argument>
  <argument name="timeout"><integer>3600</integer></argument>
  <argument name="args"><set>
    <text>$PRCONFIGOPTS/Brunel/PR-COLLISION12-Beam4000GeV-VeloClosed-MagDown.py</text>
    <text>$APPCONFIGOPTS/Brunel/MonitorExpress.py</text>
    <text>--option</text>
    <text>from Brunel.Configuration import *; Brunel().EvtMax=200; Brunel().Monitors=["SC","FPE"]; Brunel().DatasetName="brunel2012magdown"; from Configurables import DDDBConf; DDDBConf().InitialTime="Now"</text>
  </set></argument>
  <argument name="reference"><text>../refs/brunel2012magdown.ref</text></argument>
  <argument name="validator"><text>
#check if the output exists, and check the split locations are on it
from RawEventCompat.QMTest.FormatTests import checkIsSplit, checkIsGone
checkIsSplit("brunel2012magdown-200ev.dst",4.0,causes,result,"brunel.brunel2012magdown")
checkIsGone("brunel2012magdown-200ev.dst",["Event/DAQ"],causes,result,"brunel.brunel2012magdown")

from Brunel.QMTest.BrunelExclusions import preprocessor as BrunelPreprocessor
preprocessor = BrunelPreprocessor + \
  RegexpReplacer(r'mdf:\S*(/lhcb/data\S*\.raw)(\?\S*)?',r'\1')
validateWithReference(preproc = preprocessor)
findReferenceBlock("""
ChargedProtoANN...SUCCESS List of booked 1D histograms in directory         "PROTO/ChargedProtoANNPIDMoni" :-
 | ID                        |   Title                                       |    #    |     Mean   |    RMS     |  Skewness  |  Kurtosis  |
 | Downstream/ElectronANN    | "Downstream Electron ANN PID"                 |   4295  |   0.056869 | 0.1646     |     4.0208 |     16.305 |
 | Downstream/GhostANN       | "Downstream Ghost ANN PID"                    |   4295  |    0.80144 | 0.28392    |     -1.558 |     1.0851 |
 | Downstream/KaonANN        | "Downstream Kaon ANN PID"                     |   4295  |   0.009899 | 0.038536   |     13.069 |     225.11 |
 | Downstream/MuonANN        | "Downstream Muon ANN PID"                     |   4295  |  0.0023273 | 0.034351   |     21.822 |      522.9 |
 | Downstream/PionANN        | "Downstream Pion ANN PID"                     |   4295  |    0.10352 | 0.20359    |     2.7386 |     7.0383 |
 | Downstream/ProtonANN      | "Downstream Proton ANN PID"                   |   4295  |   0.022719 | 0.062354   |     6.1811 |     48.832 |
 | Long/ElectronANN          | "Long Electron ANN PID"                       |  10433  |   0.025675 | 0.11505    |     6.1034 |     39.337 |
 | Long/GhostANN             | "Long Ghost ANN PID"                          |  10433  |    0.43222 | 0.42859    |    0.32263 |    -1.7344 |
 | Long/KaonANN              | "Long Kaon ANN PID"                           |  10433  |   0.060248 | 0.15258    |     3.9158 |     16.441 |
 | Long/MuonANN              | "Long Muon ANN PID"                           |  10433  |   0.006973 | 0.06286    |     11.741 |     147.83 |
 | Long/PionANN              | "Long Pion ANN PID"                           |  10433  |    0.42988 | 0.39989    |    0.19791 |     -1.704 |
 | Long/ProtonANN            | "Long Proton ANN PID"                         |  10433  |   0.035849 | 0.093526   |     5.2349 |     35.364 |
 | Upstream/ElectronANN      | "Upstream Electron ANN PID"                   |   1375  |   0.052774 | 0.11942    |     4.0735 |     20.015 |
 | Upstream/GhostANN         | "Upstream Ghost ANN PID"                      |   1375  |    0.40912 | 0.35583    |    0.28571 |    -1.5164 |
 | Upstream/KaonANN          | "Upstream Kaon ANN PID"                       |   1375  |   0.054178 | 0.068583   |     3.5718 |     17.748 |
 | Upstream/MuonANN          | "Upstream Muon ANN PID"                       |   1375  |  0.0043301 | 0.020877   |     33.891 |     1212.8 |
 | Upstream/PionANN          | "Upstream Pion ANN PID"                       |   1375  |    0.38155 | 0.27755    |    0.29108 |    -1.2289 |
 | Upstream/ProtonANN        | "Upstream Proton ANN PID"                     |   1375  |   0.031193 | 0.049839   |     3.3161 |     15.345 |
""", id = "ChargedProtoANN" )
</text></argument>
</extension>
