<?xml version="1.0" ?><!DOCTYPE extension  PUBLIC '-//QM/2.3/Extension//EN'  'http://www.codesourcery.com/qm/dtds/2.3/-//qm/2.3/extension//en.dtd'>
<extension class="GaudiTest.GaudiExeTest" kind="test">
  <argument name="program"><text>gaudirun.py</text></argument>
  <argument name="timeout"><integer>3600</integer></argument>
  <argument name="args"><set>
    <text>$PRCONFIGOPTS/Brunel/PR-COLLISION12-Beam4000GeV-VeloClosed-MagDown.py</text>
    <text>$APPCONFIGOPTS/Brunel/MonitorExpress.py</text>
    <text>--option</text>
    <text>from Brunel.Configuration import *; Brunel().EvtMax=200; Brunel().Monitors=["SC","FPE"]; Brunel().DatasetName="brunel2012magdown"</text>
  </set></argument>
  <argument name="reference"><text>../refs/brunel2012magdown.ref</text></argument>
  <argument name="validator"><text>
#check if the output exists, and check the split locations are on it
from RawEventCompat.QMTest.FormatTests import checkIsSplit, checkIsGone
checkIsSplit("brunel2012magdown-200ev.dst",2.0,causes,result,"brunel.brunel2012magdown")
checkIsGone("brunel2012magdown-200ev.dst",["Event/DAQ"],causes,result,"brunel.brunel2012magdown")

from Brunel.QMTest.BrunelExclusions import preprocessor as BrunelPreprocessor
preprocessor = BrunelPreprocessor + \
  RegexpReplacer(r'mdf:\S*(/lhcb/data\S*\.raw)(\?\S*)?',r'\1')
validateWithReference(preproc = preprocessor)
findReferenceBlock("""
ChargedProtoANN...SUCCESS List of booked 1D histograms in directory         "PROTO/ChargedProtoANNPIDMoni" :-
 | ID                        |   Title                                       |    #    |     Mean   |    RMS     |  Skewness  |  Kurtosis  |
 | Downstream/ElectronANN    | "Downstream Electron ANN PID"                 |   3963  |    0.05596 | 0.16703    |     4.0413 |     16.353 |
 | Downstream/GhostANN       | "Downstream Ghost ANN PID"                    |   3963  |    0.80174 | 0.28489    |    -1.5733 |     1.1191 |
 | Downstream/KaonANN        | "Downstream Kaon ANN PID"                     |   3963  |    0.01012 | 0.040338   |     12.817 |     208.23 |
 | Downstream/MuonANN        | "Downstream Muon ANN PID"                     |   3963  |  0.0021796 | 0.033019   |     22.398 |      556.1 |
 | Downstream/PionANN        | "Downstream Pion ANN PID"                     |   3963  |    0.10741 | 0.20919    |     2.7099 |     6.7708 |
 | Downstream/ProtonANN      | "Downstream Proton ANN PID"                   |   3963  |   0.023002 | 0.062881   |     6.0193 |      46.45 |
 | Long/ElectronANN          | "Long Electron ANN PID"                       |  10420  |   0.023033 | 0.10978    |     6.4556 |      44.29 |
 | Long/GhostANN             | "Long Ghost ANN PID"                          |  10420  |    0.43296 | 0.42863    |    0.31922 |    -1.7363 |
 | Long/KaonANN              | "Long Kaon ANN PID"                           |  10420  |   0.061091 | 0.15362    |     3.8688 |     15.985 |
 | Long/MuonANN              | "Long Muon ANN PID"                           |  10420  |  0.0072279 | 0.064094   |      11.53 |     142.46 |
 | Long/PionANN              | "Long Pion ANN PID"                           |  10420  |    0.43465 | 0.40137    |    0.18078 |    -1.7146 |
 | Long/ProtonANN            | "Long Proton ANN PID"                         |  10420  |   0.035913 | 0.093951   |     5.2228 |     35.049 |
 | Upstream/ElectronANN      | "Upstream Electron ANN PID"                   |   1355  |   0.051556 | 0.11806    |      4.113 |     20.275 |
 | Upstream/GhostANN         | "Upstream Ghost ANN PID"                      |   1355  |    0.40292 | 0.35602    |     0.3164 |    -1.5068 |
 | Upstream/KaonANN          | "Upstream Kaon ANN PID"                       |   1355  |   0.055399 | 0.07127    |     3.5425 |     16.891 |
 | Upstream/MuonANN          | "Upstream Muon ANN PID"                       |   1355  |  0.0043546 | 0.021026   |     33.665 |     1196.1 |
 | Upstream/PionANN          | "Upstream Pion ANN PID"                       |   1355  |    0.38614 | 0.27823    |    0.26557 |    -1.2399 |
 | Upstream/ProtonANN        | "Upstream Proton ANN PID"                     |   1355  |   0.031453 | 0.049981   |     3.2894 |      15.28 |
""", id = "ChargedProtoANN" )
</text></argument>
</extension>
